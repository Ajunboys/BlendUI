<!doctype html>
<html>

<head>
    <!-- <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>测试layer web页面</title>
    <link rel="stylesheet" href="crema.css">
    <script src="../third_party/require.js"></script>
    <style>
    /*::-webkit-scrollbar{
        display:none;
    }*/

    </style>
</head>

<body>
    <div class="statusbar-overlay"></div>
    <div class="panel-overlay"></div>
    <div class="views">
        <div class="view">
            
            <div class="pages">
                <div class="page page-on-center">
                    <div class="navbar">
                        <div class="navbar-inner">
                            <div class="center">测试layer</div>
                        </div>
                    </div>
                    <div class="page-content">
                    <div class="list-block">
                        <ul>
                            <li><a href="sub/list.html" class="item-link item-content"><div class="item-media"><img src="img/list.png" alt="" width="85"></div><div class="item-inner"> home page -》 item list link</div> </a></li>
                            <li><a href="sub/list.html" class="item-link item-content"><div class="item-media"><img src="img/list.png" alt="" width="85"></div><div class="item-inner"> home page -》 item list link</div> </a></li>
                            <li><a href="sub/list.html" class="item-link item-content"><div class="item-media"><img src="img/list.png" alt="" width="85"></div><div class="item-inner"> home page -》 item list link</div> </a></li>
                            <li><a href="sub/list.html" class="item-link item-content"><div class="item-media"><img src="img/list.png" alt="" width="85"></div><div class="item-inner"> home page -》 item list link</div> </a></li>
                            <li><a href="sub/list.html" class="item-link item-content"><div class="item-media"><img src="img/list.png" alt="" width="85"></div><div class="item-inner"> home page -》 item list link</div> </a></li>
                            <li><a href="sub/list.html" class="item-link item-content"><div class="item-media"><img src="img/list.png" alt="" width="85"></div><div class="item-inner"> home page -》 item list link</div> </a></li>
                            <li><a href="sub/list.html" class="item-link item-content"><div class="item-media"><img src="img/list.png" alt="" width="85"></div><div class="item-inner"> home page -》 item list link</div> </a></li>
                            <li><a href="sub/list.html" class="item-link item-content"><div class="item-media"><img src="img/list.png" alt="" width="85"></div><div class="item-inner"> home page -》 item list link</div> </a></li>
                            <li><a href="sub/list.html" class="item-link item-content"><div class="item-media"><img src="img/list.png" alt="" width="85"></div><div class="item-inner"> home page -》 item list link</div> </a></li>
                            <li><a href="sub/list.html" class="item-link item-content"><div class="item-media"><img src="img/list.png" alt="" width="85"></div><div class="item-inner"> home page -》 item list link</div> </a></li>
                            <li><a href="sub/list.html" class="item-link item-content"><div class="item-media"><img src="img/list.png" alt="" width="85"></div><div class="item-inner"> home page -》 item list link</div> </a></li>
                            <li><a href="sub/list.html" class="item-link item-content"><div class="item-media"><img src="img/list.png" alt="" width="85"></div><div class="item-inner"> home page -》 item list link</div> </a></li>
                            <li><a href="sub/list.html" class="item-link item-content"><div class="item-media"><img src="img/list.png" alt="" width="85"></div><div class="item-inner"> home page -》 item list link</div> </a></li>
                        </ul>
                    </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    
</body>
<script>
requirejs(['../third_party/zepto','../src/web/blend','../src/web/Layer','../src/web/LayerGroup','../src/web/Slider','../src/web/dialog/Preloader'], function (nothing, main, layer,LayerGroup,slider,preloader) {
    
    main.Slider = slider;

    window.blend = main;

    blend.Layer = layer;

    window.Blend={};Blend.ui = blend;
    // window._layer;
    blend.on("layercreates",function(event){
        console.log("onevents..... ",event);
    });
    $(document).click(function(e){
        blend.fire("layercreates","0",{data1:123,data2:[1,2,3]});

        var _layer = window._layer;
        var $t = $(e.target).closest('a');
        if (!$t.length) return true;
        if ($t.hasClass("back")) { //有class name back 则 后退，否则，进入
            _layer.out();
            return false;
        }
        if ($t.hasClass("reload")) { //有class name back 则 后退，否则，进入
            _layer.reload('sub/list.html');
            return false;
        }
        e.preventDefault();
        window._layer && window._layer.destroy();
        window._layer = new layer({
            "id":"info",
            "url": $t.attr('href'),
            "active":true
            ,"onrender":function(){
                console.log("onrender...");
                /*alert("afterrender:"+this.id+"_event");
                alert(location.href);*/
            }
            ,"onload":function(event){
                console.log("onload...");
                /*alert(event['origin']);
                alert("onload:"+this.id+"_event");
                alert(location.href);*/
            }
            ,"changeUrl":function(event){
                // console.log("onload");
                console.log(event['url'])
            }
            ,"ptrFn":function(){
                setTimeout(function(){
                    console.log("refresh callback");
                    _layer.endPullRefresh();

                },1500);
                
            }
        });
        // $(".list-block a:first").click();
       
    });

        var Slider = main.Slider;
            var images = [];
            $(".list-block li").each(function(i, n) {
                images.push({
                    url: $(this).find('img')[0].src
                });
                $(this).click(function(e) {
                    location.hash==='#slider'?location.hash="" : location.hash="slider";
                    setTimeout(function() {
                        typeof slider2!=='undefined' &&slider2.slideTo(i);
                    }, 100)
                });
            });
            // var slider;
            window.onhashchange = function(e) {
                var hash = location.hash.slice(1);
                if (hash == "slider") {
                    window.slider2 = new Slider({
                        "id": "test",
                        "bgColor": "#cccccc",
                        "images": images,
                        hasIndicator: true,
                        inactiveColor: "#888888",
                        activeColor: "#ff0000",
                        "tap": function(e) {
                            history.back();
                        },
                        'slide': function(e) {
                            console.log(e.data.index)
                        }
                    });
                } else {
                    typeof slider2!=='undefined' && slider2.destroy();
                }
            };
            
    // window.pre = new preloader("载入中");
    // pre.open();
    
});
</script>
</html>
