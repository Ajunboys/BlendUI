<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>layer功能测试</title>
    <link rel="stylesheet" href="">
    <script src="../../../third_party/zepto.js"></script>
    <script src="../../../dist/BlendUI-0.2.2.js"></script>
</head>
<body>
layer测试<br/><br/>


<!-- <input type="button" id="create" value="创建layer"/>window.lc_bridge.prepareLayer<br/>
<input type="button" id="resumeLayer" value="激活layer"/>window.lc_bridge.resumeLayer<br/> -->
<input type="button" id="back" value="返回"/>

<input type="button" id="close" value="销毁"/>
<br>
<hr>
<input type="button" id="postMessage" value="postMessage数据给父层"/>
<br/>
<br/>
<hr/>
<input type="button" id="selfEvent" value="触发父层的自定义事件"/>
<br/>
<br/>
<hr/>
<a href="http://m.baidu.com">可测试changeUrl事件</a>
<a href="index_demo1.html">可测试back事件</a>
</body>
<script>
;(function (main,Layer,LayerGroup) {
    var _layer;
    var layerApi = main.api.layer;
    var _eval = {
        back:function(){
            layerApi.back();
        },
        close:function(){
            layerApi.destroy();
        },
        postMessage:function(){
            layerApi.postMessage("12345","top");
            layerApi.back();
        },
        selfEvent:function(){
            layerApi.fire('baidu',"top",{"aaa":"bbbbbbb"},function(data){
                alert("baidu的回调"+data.ccc);
            });

            /*layerApi.fire('baidu',"top",{"aaa":"ddddd"},function(data){
                alert("baidu的回调1"+data.ccc);
            });

            layerApi.fire('book',"top",{"aaa":"ccccc"},function(data){
                //alert(111);
                alert("book的回调"+data.ccc);
            });*/
        }
    };

    $('input[type=button]').click(function(e){
        var id = this.id;
        console.log(id+"=============="+id);
        _eval[id] && _eval[id]();
    });


    /*layerApi.on("layerGoBack",function(){
        alert('bbbbb');
    });
    */
    /*console.log("referrer:"+document.referrer);*/
/*document.addEventListener('menuPressed', function(event) {
    console.log('menuPressed origin: ' + event['origin']);
}, false);*/


var dd = 1*new Date();
document.addEventListener('runtimeready', function() {
    window.nuwa_runtime && nuwa_runtime.removeSplashScreen();
    console.log("timetime:" + (1*new Date()-dd));
    //nuwa.pm.bindAk('wTk7LUNhzrRpTYlcRK3Ltk8f');
    //加载所有依赖的插件
    nuwa.pm.absorb('device', function(inst) {
        
        inst.on('error', function(err) {
            console.info('adb_yuedu: device inst error:' + err);
        });

        inst.on('complete', function() {
            console.info("timetime:"+ (1*new Date()-dd));
            
            nuwa.pm.absorb('filetransfer', function(inst) {

                inst.on('error', function(err) {
                    console.info('adb_yuedu: filetransfer inst error:' + err);
                });

                inst.on('complete', function() {
                    console.info("timetime:"+ (1*new Date()-dd));
                    console.info('adb_yuedu: complete');
                    
                    window.plg.filetransfer = nuwa.require('filetransfer');

                    cb && cb();

                });

                inst.on('progress', function(percentage) {
                    console.log('adb_yuedu: filetransfer' + 'percentage = ' + percentage);
                });
            });
            window.plg.device = nuwa.require('device');
        });

        inst.on('progress', function(percentage) {
            console.log('adb_yuedu: device' + 'percentage = ' + percentage);
        });
    });

});

})(Blend,Blend.Layer,Blend.LayerGroup);
</script>
</html>